# 2025 - 11 - 04 

use my_db;
 
--  drop table healthcare;
 select * from healthcare;
 alter table healthcare drop column new_requesting_date;
alter table healthcare drop column new_appointment_date;
 
 select * from train;
alter table train drop column new_order_date;
alter table train drop column new_ship_date;
 
 
 select * from train;

-- alter table train modify column `Order Date` datetime;
describe train;

-- fetch all transaction records for order date 2017 
select * from train where `Order Date` = '8/11/2017';
select * from train where `Order Date` = '2017';
select * from train where `Order Date` like '%2017%';

select * from train where `Order Date`like '%11%'; -- month wise 

-- 
select now(), curdate(),current_date(),current_time(),curtime(),current_timestamp();

-- year(), month(), days()
select * ,year(`Requesting date`),month(`Requesting date`),day(`Requesting date`) from healthcare;

select * from train where year(`Order Date`) = '2017';

select dayofyear(now());

# ðŸ”€ Formatting and Conversion
# --Function	Description	Example	Output
DATE_FORMAT(date, format)	Format a date string	SELECT DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i');	2025-04-24 15:30 <br>
STR_TO_DATE(str, format)	Convert string to date	SELECT STR_TO_DATE('24-04-2025','%d-%m-%Y');	2025-04-24 <br>
TIME_FORMAT(time, format)	Format time	SELECT TIME_FORMAT('15:30:45', '%H:%i');	15:30 <br>
EXTRACT(unit FROM date)	Extract date part	SELECT EXTRACT(YEAR FROM '2025-04-24');	2025  <br>

SELECT now(),DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s'),DATE_FORMAT(NOW(), '%y-%m-%d %h:%i:%s'),
DATE_FORMAT(NOW(), '%Y-%M-%W %h:%i:%s');
-- Get only the time part (HH:MM:SS) from the created_at column in the logs table.

%M -> month name 
%I -> hour number ( 12 hours time ) 
%p -> am/pm ( 12  hours ) 
%a -> short week name  
%W -> full week name 

%Y -> full year number 
%y -> short year number 
%m -> month  number 
%d -> days number 
%H -> ( 24 hours ) 
%h -> ( 12 hours ) 
%i -> minutes 
%s -> second 

select now(),date_format(now(),"%H:%i:%s") , date_format(now(),"%H:%I:%S")


-- -- Date format 
select `Appointment date`, date_format(`Appointment date`,"%Y-%m-%d"),date_format(`Appointment date`,"%h-%i-%s %p"), date_format(`Appointment date`,"%W-%M-%Y"),
date_format(`Appointment date`,"%d-%m-%Y")
from healthcare;


-- Str to date 

select `Order Date`, str_to_date(`Order Date`,"%d/%m/%Y")
from train;

alter table train modify `Order Date` datetime ;
alter table train add column new_order_date datetime;
update train set new_order_date = str_to_date(`Order Date`,"%d/%m/%Y");

select `Ship Date`, str_to_date(`Ship Date`,"%d/%m/%Y") from train;

alter table train add column new_ship_date datetime;
update train set new_ship_date = str_to_date(`Ship Date`,"%d/%m/%Y");

select * from train;

select new_order_date, date_format(new_order_date,"%Y-%m-%d"),date_format(new_order_date,"%h-%i-%s %p"), date_format(new_order_date,"%W-%M-%Y"),
date_format(new_order_date,"%d-%m-%Y")
from train;

-- Get the records for specific year or month or day
select new_order_date,year(new_order_date),month(new_order_date),day(new_order_date) from train 
where year(new_order_date) = 2016;

select new_order_date, dayofweek(new_order_date) , dayofyear(new_order_date) , hour(new_order_date),
minute(new_order_date),second(new_order_date) , week(new_order_date),weekday(new_order_date), 
quarter(new_order_date) from train;


-- find total number of records for each year and months
select  year(new_order_date) year, month(new_order_date) month, count(*) 
from train  group  by year(new_order_date) , month(new_order_date) 
order by year(new_order_date) desc , month(new_order_date) desc;

-- with CTE
select * , count(*) from
(
select  year(new_order_date) year, month(new_order_date) month
from train  
) as t 
group  by year , month
order by year desc , month desc;

-- find sum of sales , average of sales for each quarter of order date 
select * from train limit 5;
select quarter(new_order_date) , sum(sales) , avg(sales) 
from train group by quarter(new_order_date);

-- Date_formate 
select `Ship Date`,date_format(`Ship Date`,"%W-%M-%Y"),date_format(`Ship Date`,"%y-%M-%D") ,
date_format(`Ship Date`,"%Y-%m-%d %h-%i-%s %p") from train;


select * from healthcare;

select `Requesting date` , str_to_date(`Requesting date`,"%m/%d/%y %h:%i %p") 
from healthcare;

select `Appointment date` , str_to_date(`Appointment date`,"%m/%d/%Y %h:%i%p") 
from healthcare;

alter table healthcare add column new_requesting_date datetime;
alter table healthcare add column new_appointment_date datetime;
describe healthcare;
update healthcare set new_requesting_date = str_to_date(`Requesting date`,"%m/%d/%Y %h:%i%p") ;
alter table healthcare modify `Appointment date` datetime;

-- update healthcare set `Appointment date` = str_to_date(`Appointment date`,"%d/%m/%Y");
 
UPDATE healthcare 
SET new_appointment_date = STR_TO_DATE(`Appointment date`, '%m/%d/%y %h:%i %p');

UPDATE healthcare 
SET `Appointment date` = STR_TO_DATE(`Appointment date`, "%c/%e/%y %r"); 

-- date_format
select * from healthcare;
    
-- find all healthcare reports for each requsting date and appointment date should be equal ?



# 2025 - 11 - 17 

use my_db;

select * from train;
select * from healthcare;

-- find all healtcare reports for same date of `Requesting date` = `Appointment date`
select * from healthcare where `Requesting date` = `Appointment date`;
select * from healthcare 
-- where new_requesting_date = new_appointment_date
order by new_requesting_date,new_appointment_date;

select * from healthcare where day(`Requesting date`) = day(`Appointment date`);
select * from healthcare where day(new_requesting_date) = day(new_appointment_date);

select * from healthcare where date_format(`Requesting date`,"%Y-%m-%d") = date_format(`Appointment date`,"%Y-%m-%d");
select * from healthcare where date_format(new_requesting_date,"%Y-%m-%d") = date_format(new_appointment_date,"%Y-%m-%d");

-- date_add ,adddate , date_sub, subdate 
-- for 1 day 
select * , date_add(new_requesting_date,interval 1 day)  from healthcare 
where date_add(new_requesting_date,interval 1 day)  = new_appointment_date;

select * , date_add(new_requesting_date,interval 1 day)  from healthcare 
where date_format(date_add(new_requesting_date,interval 1 day),"%Y-%m-%d")  = date_format(new_appointment_date,"%Y-%m-%d");


-- for 2 day 
select * , date_add(`Requesting date`,interval 2 day)  from healthcare 
where date_format(date_add(new_requesting_date,interval 2 day),"%Y-%m-%d")  = date_format(new_appointment_date,"%Y-%m-%d");

-- for 1 months 
select * , date_add(new_requesting_date,interval 1 month)  from healthcare 
where date_format(date_add(new_requesting_date,interval 1 month),"%Y-%m-%d")  = date_format(new_appointment_date,"%Y-%m-%d");

select * , date_add(`Requesting date`,interval 1 month)  from healthcare 
where month(date_add(`Requesting date`,interval 1 month))  = month(`Appointment date`);


-- Comparing order date with ship date for 1 days
select * from train;

select *, date_add(new_order_date,interval 1 day) from train 
where new_order_date = subdate(new_ship_date,interval 1 day);

-- Comparing order date with ship date for 2 days
select *, date_add(new_order_date,interval 1 day) from train 
where new_order_date = subdate(new_ship_date,interval 2 day);


-- difference between 
select datediff(now(),'2025-11-15');
select * from train where datediff(new_ship_date,new_order_date) = 2;

select * , datediff(now(), date_sub(now(),interval 7 day));
select *,datediff(new_ship_date, date_sub(new_order_date,interval 7 day))
from train where datediff(new_ship_date, date_sub(new_order_date,interval 7 day))= 7 ;

select `Order Date`,`Ship Date`,datediff(new_ship_date,new_order_date) as diff 
from train ;

-- Get all ship date from past three order date 
with etc as ( 
select `Order Date`,`Ship Date`,datediff(new_ship_date,new_order_date) as diff 
from train ) 
select * from etc where diff <=3;

select timediff(now(),'2025-04-24'); -- null 
select timediff(current_time(),'11:38:00 am'), timediff(curtime(),'4:32:00 pm');


select `Order Date`,`Ship Date`,timediff(date_format(`Ship Date`,"%h-%i-%s"),
date_format(`Order Date`,"%h-%i-%s") )as diff 
from train ;

-- extract 
select extract(year from '2025-6-01'),extract(month from '2025-6-01'), extract(day from '2025-6-01'),
extract(hour from '2025-6-01'), extract(minute from '2025-6-01') , extract(second from '2025-6-01');

select extract(hour from `Requesting date`) , extract(minute from `Requesting date`), extract(second from `Requesting date`)
from healthcare;


select * from healthcare;

select * , datediff(now(),`Requesting date`) ,datediff(now(),`Appointment date`)
from healthcare;

select * , timediff(now(),`Requesting date`) ,timediff(now(),`Appointment date`)
from healthcare;

-- 3ï¸âƒ£   Exact difference in seconds, minutes, or hours
select 
 TIMESTAMPDIFF(year, `Requesting date`, `Appointment date`) AS years,
  TIMESTAMPDIFF(month, `Requesting date`, `Appointment date`) AS months,
 TIMESTAMPDIFF(DAY, `Requesting date`, `Appointment date`) AS days,
  TIMESTAMPDIFF(HOUR, `Requesting date`, `Appointment date`) AS hours,
  TIMESTAMPDIFF(MINUTE, `Requesting date`, `Appointment date`) AS minutes,
  TIMESTAMPDIFF(SECOND, `Requesting date`, `Appointment date`) AS seconds
  from healthcare;


# 2025 - 11 - 17 

use my_db;

select * from train;
select * from healthcare;

-- find all healtcare reports for same date of `Requesting date` and `Appointment date`
select * from healthcare where `Requesting date` = `Appointment date`;
select * from healthcare 
-- where new_requesting_date = new_appointment_date
order by new_requesting_date,new_appointment_date;

select * from healthcare where day(`Requesting date`) = day(`Appointment date`);
select * from healthcare where day(new_requesting_date) = day(new_appointment_date);

select * from healthcare where date_format(`Requesting date`,"%Y-%m-%d") = date_format(`Appointment date`,"%Y-%m-%d");
select * from healthcare where date_format(new_requesting_date,"%Y-%m-%d") = date_format(new_appointment_date,"%Y-%m-%d");

-- date_add ,adddate , date_sub, subdate 
-- for 1 day 
select * , date_add(new_requesting_date,interval 1 day),
date_add(new_requesting_date,interval 1 month) , date_add(new_requesting_date,interval 1 year),
date_add(new_requesting_date,interval 1 hour)    from healthcare 
where date_add(new_requesting_date,interval 1 day)  = new_appointment_date;

select * , date_add(new_requesting_date,interval 1 day)  from healthcare 
where date_format(date_add(new_requesting_date,interval 1 day),"%Y-%m-%d")  = date_format(new_appointment_date,"%Y-%m-%d");


-- for 2 day 
select * , date_add(`Requesting date`,interval 2 day)  from healthcare 
where date_format(date_add(new_requesting_date,interval 2 day),"%Y-%m-%d")  = date_format(new_appointment_date,"%Y-%m-%d");

-- for 1 months 
select * , date_add(new_requesting_date,interval 1 month)  from healthcare 
where date_format(date_add(new_requesting_date,interval 1 month),"%Y-%m-%d")  = date_format(new_appointment_date,"%Y-%m-%d");

select * , date_add(`Requesting date`,interval 1 month)  from healthcare 
where month(date_add(`Requesting date`,interval 1 month))  = month(`Appointment date`);


-- Comparing order date with ship date for 1 days
select * from train;

select *, date_add(new_order_date,interval 1 day) from train 
where new_order_date = subdate(new_ship_date,interval 1 day);


-- Comparing order date with ship date for 2 days
select *, date_add(new_order_date,interval 1 day) from train 
where new_order_date = subdate(new_ship_date,interval 2 day);


-- difference between 
select datediff(now(),'2025-11-17'),datediff(now(),'2025-11-15') ;

select *, datediff(new_ship_date,new_order_date) as diff from train where datediff(new_ship_date,new_order_date) in(2,3,4,5);

select diff,count(*) from 
( 
select *, datediff(new_ship_date,new_order_date) as diff
from train 
-- where datediff(new_ship_date,new_order_date) in(2,3,4,5)
) t 
group by diff order by count(*) ;

-- find the order details for order date and ship date days difference is 7 .
select datediff(now(), date_sub(now(),interval 7 day));

select *,datediff(new_ship_date, date_sub(new_order_date,interval 7 day))
from train where datediff(new_ship_date, date_sub(new_order_date,interval 7 day))= 7 ;

select `Order Date`,`Ship Date`,datediff(new_ship_date,new_order_date) as diff 
from train ;

-- Get all ship date from past three order date 
with etc as ( 
select `Order Date`,`Ship Date`,datediff(new_ship_date,new_order_date) as diff 
from train ) 
select * from etc where diff <=3;

select timediff(now(),'2025-04-24'); -- null 
select timediff(current_time(),'15:55:00'), timediff(curtime(),'4:32:00 pm');


select `Order Date`,`Ship Date`,timediff(date_format(new_ship_date,"%h-%i-%s"),
date_format(new_order_date,"%h-%i-%s") )as diff 
from train ;

-- extract 
select extract(year from '2025-6-01'),extract(month from '2025-6-01'), extract(day from '2025-6-01'),
extract(hour from '2025-6-01'), extract(minute from '2025-6-01') , extract(second from '2025-6-01');

select extract(hour from `Requesting date`) , extract(minute from `Requesting date`), extract(second from `Requesting date`)
from healthcare;


select * from healthcare;

select * , datediff(now(),`Requesting date`) ,datediff(now(),`Appointment date`)
from healthcare;

select * , timediff(now(),`Requesting date`) ,timediff(now(),`Appointment date`)
from healthcare;

-- 3ï¸âƒ£   Exact difference in seconds, minutes, or hours
select 
 TIMESTAMPDIFF(year, `Requesting date`, `Appointment date`) AS years,
  TIMESTAMPDIFF(month, `Requesting date`, `Appointment date`) AS months,
 TIMESTAMPDIFF(DAY, `Requesting date`, `Appointment date`) AS days,
  TIMESTAMPDIFF(HOUR, `Requesting date`, `Appointment date`) AS hours,
  TIMESTAMPDIFF(MINUTE, `Requesting date`, `Appointment date`) AS minutes,
  TIMESTAMPDIFF(SECOND, `Requesting date`, `Appointment date`) AS seconds
  from healthcare;
  

